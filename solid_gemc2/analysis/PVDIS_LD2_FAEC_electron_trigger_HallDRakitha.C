/*
Rakitha Thu Apr 14 13:42:58 EDT 2016
file name : Get_PVDIS_trigger_efficiency_EC.C

Radial binning is 8 see trig_low_R and trig_high_R
momentum binning is 35 see P_low and P_high

Routines GetPionTriggerEffi and GetElectronTriggerEffi would return the trigger efficiency when radius index and momentum index (bin index) are passed to them
The last radii index in the trig_pi_eff and trig_ele_eff gives the trigger efficiency for all radii average

Use routines GetRadiusIndex and GetMomentumIndex to get the bin index for radius and momentum
The radius is at the front face of the EC

 */

// 8 bin
// Double_t trig_low_R[8]={110.0 ,130.0 ,150.0 ,170.0 ,190.0 ,210.0 ,230.0 ,250.0};//radius in cm
// Double_t trig_high_R[8]={130.0 ,150.0 ,170.0 ,190.0 ,210.0 ,230.0 ,250.0 ,270.0};
// Shower 6+1 Thresholds : {617.9 ,531.0 ,460.0 ,389.8 , 331.0 ,287.6,271.9 ,272.0} MeV 
// P value 3.1,2.65,2.3,2.0,1.65,1.44,1.36,1.36 GeV  with 0.2 calibration contstant

//6 bin
//by merging last 2 bin into 3rd last bin, because last 2 bins has no acceptance of electron from target, thus produced unrelaistic small electron eff. We need to this better estimated decay particle from pi0 caused rate on EC
Double_t trig_low_R[8]={110.0 ,130.0 ,150.0 ,170.0 ,190.0 ,210.0};//radius in cm
Double_t trig_high_R[6]={130.0 ,150.0 ,170.0 ,190.0 ,210.0,270.0};
 
Double_t P_low[35] = { 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0, 6.2, 6.4, 6.6, 6.8, 7.0, 7.2, 7.4, 7.6, 7.8}; //momentum in GeV
Double_t P_high[35] = { 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0, 6.2, 6.4, 6.6, 6.8, 7.0, 7.2, 7.4, 7.6, 7.8, 8.0}; 

Int_t GetRadiusIndex(Double_t radius){
  Int_t Ri=-1;
//   for (Int_t i =0; i<8;i++){
  for (Int_t i =0; i<6;i++){       
    if (radius>trig_low_R[i] && radius<=trig_high_R[i]){
      Ri=i;
      break;
    }
  }
  return Ri;
};
Int_t GetMomentumIndex(Double_t mom){
  Int_t Pi=-1;
  for (Int_t i =0; i<35;i++){
    if (mom>P_low[i] && mom<=P_high[i]){
      Pi=i;
      break;
    }
  }
  return Pi;
};


Double_t GetPionTriggerEffi(Int_t rad_index, Int_t mom_index){
  Double_t trig_pi_eff[9][35] = { { 0.018,0.014,0.018,0.007,0.023,0.022,0.007,0.049,0.082,0.092,0.095,0.157,0.157,0.155,0.230,0.271,0.235,0.264,0.315,0.308,0.342,0.345,0.326,0.331,0.356,0.436,0.372,0.439,0.481,0.392,0.390,0.415,0.413,0.455,0.432},{ 0.024,0.024,0.037,0.028,0.037,0.055,0.083,0.124,0.123,0.169,0.247,0.261,0.216,0.288,0.359,0.338,0.382,0.359,0.374,0.394,0.395,0.384,0.418,0.429,0.416,0.435,0.432,0.466,0.448,0.451,0.457,0.505,0.466,0.476,0.532},{ 0.018,0.026,0.020,0.032,0.047,0.124,0.144,0.152,0.209,0.263,0.286,0.285,0.368,0.368,0.423,0.385,0.455,0.439,0.419,0.468,0.457,0.515,0.475,0.496,0.491,0.489,0.557,0.512,0.495,0.503,0.534,0.556,0.525,0.470,0.537},{ 0.027,0.075,0.065,0.075,0.129,0.189,0.238,0.287,0.325,0.350,0.387,0.411,0.393,0.385,0.405,0.463,0.403,0.511,0.518,0.490,0.486,0.475,0.471,0.513,0.551,0.501,0.530,0.542,0.550,0.544,0.543,0.538,0.544,0.543,0.535},{ 0.032,0.071,0.111,0.121,0.181,0.270,0.337,0.360,0.386,0.389,0.440,0.392,0.430,0.486,0.500,0.488,0.523,0.542,0.590,0.479,0.538,0.552,0.550,0.527,0.566,0.608,0.554,0.534,0.529,0.542,0.617,0.610,0.553,0.585,0.613},{ 0.026,0.076,0.108,0.139,0.173,0.297,0.295,0.329,0.352,0.360,0.400,0.410,0.437,0.492,0.456,0.521,0.530,0.517,0.523,0.494,0.453,0.539,0.551,0.500,0.527,0.610,0.544,0.523,0.587,0.558,0.544,0.581,0.608,0.590,0.515},{ 0.016,0.022,0.050,0.077,0.072,0.124,0.141,0.172,0.203,0.199,0.180,0.188,0.276,0.209,0.279,0.265,0.293,0.284,0.307,0.311,0.295,0.324,0.277,0.320,0.345,0.303,0.325,0.310,0.297,0.319,0.332,0.335,0.303,0.314,0.324},{ 0.000,0.000,0.003,0.000,0.000,0.003,0.003,0.009,0.014,0.010,0.006,0.012,0.009,0.018,0.017,0.009,0.017,0.022,0.003,0.003,0.012,0.017,0.029,0.011,0.024,0.030,0.015,0.026,0.019,0.009,0.015,0.018,0.021,0.013,0.030},{ 0.020,0.039,0.054,0.062,0.085,0.141,0.156,0.189,0.214,0.234,0.258,0.265,0.289,0.306,0.336,0.344,0.356,0.369,0.388,0.368,0.373,0.392,0.390,0.387,0.411,0.433,0.416,0.411,0.426,0.416,0.431,0.447,0.430,0.437,0.428}}; 

  if (rad_index!= -1 && mom_index!=-1)
    return trig_pi_eff[rad_index][mom_index];
  else
    return 0;  
};

Double_t GetPionTriggerEffiError(Int_t rad_index, Int_t mom_index){
  Double_t trig_pi_eff_err[9][35] = { { 0.007,0.006,0.008,0.005,0.009,0.009,0.005,0.013,0.016,0.017,0.017,0.022,0.021,0.022,0.026,0.026,0.025,0.025,0.027,0.027,0.027,0.028,0.027,0.029,0.028,0.030,0.028,0.029,0.029,0.029,0.027,0.030,0.029,0.029,0.028},{ 0.008,0.009,0.011,0.009,0.011,0.013,0.015,0.018,0.019,0.023,0.024,0.026,0.023,0.027,0.027,0.026,0.028,0.027,0.028,0.028,0.028,0.027,0.029,0.028,0.028,0.029,0.028,0.029,0.028,0.028,0.028,0.027,0.028,0.028,0.029},{ 0.007,0.009,0.007,0.010,0.011,0.018,0.019,0.020,0.022,0.023,0.025,0.025,0.026,0.027,0.028,0.026,0.027,0.028,0.027,0.028,0.027,0.027,0.028,0.027,0.027,0.028,0.028,0.028,0.029,0.028,0.027,0.028,0.027,0.028,0.029},{ 0.009,0.014,0.013,0.014,0.018,0.021,0.023,0.025,0.026,0.027,0.027,0.027,0.026,0.025,0.026,0.028,0.026,0.028,0.027,0.026,0.028,0.028,0.027,0.027,0.027,0.026,0.027,0.028,0.027,0.027,0.028,0.027,0.027,0.027,0.027},{ 0.009,0.014,0.016,0.018,0.021,0.023,0.026,0.026,0.026,0.026,0.026,0.026,0.026,0.026,0.026,0.026,0.028,0.026,0.026,0.026,0.027,0.028,0.026,0.027,0.027,0.026,0.026,0.028,0.026,0.026,0.026,0.027,0.027,0.026,0.027},{ 0.008,0.014,0.016,0.018,0.021,0.024,0.026,0.025,0.026,0.026,0.026,0.026,0.027,0.026,0.026,0.026,0.026,0.028,0.026,0.027,0.027,0.026,0.025,0.028,0.026,0.026,0.027,0.028,0.027,0.027,0.026,0.026,0.026,0.025,0.027},{ 0.006,0.008,0.011,0.014,0.014,0.017,0.018,0.020,0.021,0.021,0.020,0.021,0.025,0.021,0.024,0.024,0.025,0.024,0.024,0.024,0.025,0.026,0.024,0.025,0.025,0.024,0.025,0.024,0.024,0.025,0.025,0.025,0.025,0.025,0.025},{ 0.000,0.000,0.003,0.000,0.000,0.003,0.003,0.005,0.006,0.005,0.004,0.006,0.005,0.007,0.007,0.005,0.007,0.008,0.003,0.003,0.006,0.007,0.009,0.006,0.008,0.010,0.006,0.009,0.007,0.005,0.007,0.007,0.008,0.006,0.009},{ 0.003,0.004,0.004,0.005,0.005,0.007,0.007,0.008,0.008,0.008,0.008,0.009,0.009,0.009,0.009,0.009,0.009,0.009,0.009,0.009,0.009,0.009,0.009,0.009,0.010,0.010,0.009,0.010,0.010,0.010,0.009,0.010,0.010,0.010,0.010}}; 

  if (rad_index!= -1 && mom_index!=-1)
    return trig_pi_eff_err[rad_index][mom_index];
  else
    return 0;  
};

Double_t GetElectronTriggerEffi(Int_t rad_index, Int_t mom_index){
  Double_t trig_ele_eff[9][35] = { { 0.017,0.019,0.028,0.020,0.035,0.064,0.129,0.265,0.371,0.532,0.784,0.942,0.978,0.992,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000},{ 0.022,0.017,0.017,0.051,0.049,0.119,0.239,0.375,0.644,0.861,0.970,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000},{ 0.029,0.038,0.036,0.046,0.123,0.248,0.519,0.790,0.943,0.988,0.994,1.000,0.993,1.000,1.000,1.000,1.000,1.000,1.000,1.000,0.994,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000},{ 0.041,0.074,0.072,0.115,0.349,0.660,0.844,0.909,0.955,0.980,0.994,0.981,1.000,0.994,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000},{ 0.054,0.044,0.162,0.233,0.660,0.845,0.861,0.931,0.952,0.980,0.995,0.995,1.000,1.000,1.000,0.994,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000},{ 0.042,0.061,0.263,0.487,0.772,0.805,0.904,0.920,0.962,0.959,1.000,0.989,0.989,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000,1.000},{ 0.034,0.025,0.094,0.330,0.556,0.654,0.756,0.774,0.854,0.874,0.894,0.876,0.942,0.934,0.941,0.955,0.962,0.939,0.974,0.989,0.978,0.988,0.984,0.980,0.979,0.976,0.977,0.989,0.970,0.981,0.973,0.994,0.979,0.968,0.995},{ 0.000,0.000,0.006,0.000,0.013,0.024,0.051,0.021,0.047,0.093,0.050,0.081,0.091,0.087,0.101,0.086,0.098,0.089,0.101,0.112,0.144,0.135,0.130,0.202,0.129,0.144,0.202,0.124,0.171,0.101,0.156,0.156,0.157,0.245,0.162},{ 0.030,0.035,0.091,0.172,0.344,0.462,0.542,0.634,0.728,0.780,0.834,0.873,0.874,0.872,0.884,0.866,0.886,0.881,0.881,0.899,0.896,0.881,0.894,0.896,0.876,0.880,0.899,0.880,0.890,0.882,0.907,0.889,0.882,0.907,0.895}}; 
  if (rad_index!= -1 && mom_index!=-1)
    return trig_ele_eff[rad_index][mom_index];
  else
    return 0;
};

Double_t GetElectronTriggerEffiError(Int_t rad_index, Int_t mom_index){
  Double_t trig_ele_eff_err[9][35] = { { 0.010,0.011,0.014,0.012,0.015,0.021,0.027,0.036,0.040,0.045,0.035,0.020,0.011,0.008,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},{ 0.011,0.010,0.010,0.017,0.018,0.028,0.032,0.037,0.039,0.027,0.013,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},{ 0.012,0.014,0.014,0.016,0.027,0.035,0.040,0.032,0.019,0.009,0.006,0.000,0.007,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.006,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},{ 0.014,0.020,0.019,0.023,0.036,0.033,0.027,0.022,0.016,0.010,0.006,0.011,0.000,0.006,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},{ 0.016,0.015,0.026,0.035,0.034,0.029,0.026,0.019,0.016,0.012,0.005,0.005,0.000,0.000,0.000,0.006,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},{ 0.014,0.017,0.031,0.036,0.032,0.029,0.022,0.019,0.014,0.014,0.000,0.007,0.008,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000,0.000},{ 0.012,0.011,0.021,0.031,0.038,0.033,0.031,0.030,0.025,0.023,0.022,0.025,0.016,0.019,0.018,0.016,0.014,0.018,0.013,0.007,0.011,0.008,0.009,0.010,0.011,0.011,0.012,0.008,0.012,0.011,0.012,0.006,0.012,0.013,0.005},{ 0.000,0.000,0.006,0.000,0.009,0.012,0.016,0.011,0.016,0.021,0.016,0.022,0.022,0.021,0.024,0.021,0.023,0.023,0.023,0.026,0.028,0.026,0.026,0.031,0.025,0.026,0.031,0.024,0.029,0.023,0.031,0.027,0.027,0.034,0.028},{ 0.004,0.005,0.007,0.010,0.013,0.014,0.013,0.013,0.012,0.011,0.010,0.009,0.009,0.009,0.009,0.009,0.009,0.009,0.009,0.008,0.008,0.009,0.008,0.008,0.009,0.009,0.008,0.009,0.009,0.009,0.008,0.008,0.009,0.008,0.008}};
  if (rad_index!= -1 && mom_index!=-1)
    return trig_ele_eff_err[rad_index][mom_index];
  else
    return 0;
};
